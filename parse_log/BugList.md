
[TOC]

# BugList


## 模板

* 【日期】：
* 【问题】：
* 【由来】：
* 【原因】：
* 【修复】：
* 【改动】：
* 【教训】：


## Debug下偶发程序读到106015停止


* 【简述】：

* 【日期】：
	2018-08-19

* 【问题】：
	Debug模式下, 程序总会在读取到某一位置(如:106015)时卡住不动了; Release模式下则正常

* 【复现】：
	对应git版本:
	   ID		  作者			   日期
    8cbab89d	M_Kepler	2018/8/18 16:43:43

* 【过程】：
	debug模式下执行, 复现问题后中断调试后, 查看变量的值发现, mymap中很多元素都是**读取字符串的字符时出错**

* 【原因】：
	多线程模式下, 对map进行插入操作会有问题, STL的容器都不是线程安全的

* 【修复】：
	每个线程对各自的map进行插入操作, 最后再把所有的map组合起来
	**但是** 在改之前时间在600ms左右, 现在线程插入完后还要遍历组合, 时间是1000ms左右...

* 【改动】：
    multi_thread.cpp
	multi_thread.h

* 【教训】：
 * 变量要初始化，要防范野指针
 [VS2013 调试时读取字符串的字符时出错](https://blog.csdn.net/lemonaha/article/details/55506830)
 * 特例:dll版本的问题
 [读取字符串的字符时出错](https://blog.csdn.net/wswxfwps/article/details/51419220)
 * STL的map不是线程安全的, 多线程下很容易爆发问题
 [STL容器是否是线程安全的](https://www.cnblogs.com/ztteng/archive/2013/11/07/3411738.html)
 * 如果还有多线程同时读写, 写要注意线程安全问题, 读还要注意线程同步问题


 ## 文件只有一行且末尾没有换行符时

* 【日期】：20180905 - 14:20
* 【问题】：当文件只有一行,且莫行没有换行符时, 用seekg(0, ios::end)无法取得指向文件末尾的指针
* 【由来】：
* 【原因】：https://blog.csdn.net/super_zq/article/details/78251192
* 【修复】：在seekg之前先clear
* 【改动】：
* 【教训】：


 ## 获取文件最后一行时, 同一程序linux下和windows下运行结果不一样, windows下会多读几个字符

 怀疑是编译器的问题, 我把代码放到linux下用g++编译, 运行正常



